<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catálogo de Televisores</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        #search {
            margin-bottom: 10px;
            padding: 10px;
            width: 80%;
            border: 1px solid #ddd;
        }
        #searchButton {
            padding: 10px 15px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
        }
        .barcode {
            height: 80px; /* Ajusta la altura como desees */
        }
    </style>
    <!-- Incluir JsBarcode desde un CDN -->
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.0/dist/JsBarcode.all.min.js"></script>
    <script src="television.js"></script> <!-- Incluir el archivo de datos -->
</head>
<body>
    <h1>Catálogo de Televisores</h1>
    <input type="text" id="search" placeholder="Buscar por nombre del producto..." oninput="convertToUpper()">
    <button id="searchButton" onclick="filterTable()">Buscar</button>

    <table id="productTable">
        <thead>
            <tr>
                <th>Fecha Inicio</th>
                <th>Fecha Fin</th>
                <th>Tipo</th>
                <th>Categoría</th>
                <th>Subcategoría</th>
                <th>Nombre Producto</th>
                <th>Código</th>
                <th>Referencia</th>
                <th>Tipo de Producto</th>
                <th>Disponibilidad</th>
                <th>Precio</th>
            </tr>
        </thead>
        <tbody>
            <!-- Aquí se insertarán los datos -->
        </tbody>
    </table>

    <script>
        function populateTable() {
            const rows = data.split('\n'); // Utiliza la constante data del archivo externo
            const tableBody = document.getElementById('productTable').querySelector('tbody');

            rows.forEach(row => {
                const cols = row.split(';');
                const tr = document.createElement('tr');
                cols.forEach((col, index) => {
                    const td = document.createElement('td');
                    td.textContent = col.trim();
                    tr.appendChild(td);

                    // Si la columna es la de "Referencia", se generará el código de barras
                    if (index === 7) {
                        const barcodeImg = document.createElement('img');
                        barcodeImg.className = 'barcode'; // Clase para estilos
                        JsBarcode(barcodeImg, col.trim(), {
                            width: 4,  // Ancho de las barras
                            height: 80 // Altura del código de barras
                        }); 
                        td.innerHTML = ''; // Limpiar el contenido del td
                        td.appendChild(barcodeImg); // Añadir la imagen del código de barras
                    }
                });
                tableBody.appendChild(tr);
            });
        }

        function filterTable() {
            const input = document.getElementById('search').value.toLowerCase();
            const table = document.getElementById('productTable');
            const tableBody = table.querySelector('tbody');

            // Limpiar el contenido anterior de la tabla
            tableBody.innerHTML = '';

            const rows = data.split('\n'); // Utiliza la constante data del archivo externo
            const searchTerms = input.split(/[, ]+/).map(term => term.trim()).filter(term => term);

            rows.forEach(row => {
                const cols = row.split(';');
                const rowText = cols.join(' ').toLowerCase();

                // Verificar si todas las palabras de búsqueda están presentes en la fila
                if (searchTerms.every(term => rowText.includes(term))) {
                    const tr = document.createElement('tr');
                    cols.forEach((col, index) => {
                        const td = document.createElement('td');
                        td.textContent = col.trim();
                        tr.appendChild(td);

                        // Si la columna es la de "Referencia", se generará el código de barras
                        if (index === 7) {
                            const barcodeImg = document.createElement('img');
                            barcodeImg.className = 'barcode'; // Clase para estilos
                            JsBarcode(barcodeImg, col.trim(), {
                                width: 4,  // Ancho de las barras
                                height: 80 // Altura del código de barras
                            }); 
                            td.innerHTML = ''; // Limpiar el contenido del td
                            td.appendChild(barcodeImg); // Añadir la imagen del código de barras
                        }
                    });
                    tableBody.appendChild(tr);
                }
            });
        }

        function convertToUpper() {
            const inputField = document.getElementById('search');
            inputField.value = inputField.value.toUpperCase(); // Convertir a mayúsculas
        }

        // Llamada a la función para llenar la tabla inicialmente (vacía)
        populateTable();
    </script>
</body>
</html>
